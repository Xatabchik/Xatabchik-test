<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Вход в Панель управления</title>
		<meta name="csrf-token" content="{{ csrf_token() }}" />
		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='css/style.css') }}"
		/>
	</head>
	<body class="login-page">
		<div class="login-container">
			<h1>Вход в панель</h1>

			{% with messages = get_flashed_messages(with_categories=true) %} {% if
			messages %} {% for category, message in messages %}
			<div class="flash flash-{{ category }}">{{ message }}</div>
			{% endfor %} {% endif %} {% endwith %}

			<form method="post">
				<input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
				<div class="form-group">
					<label for="username">Логин:</label>
					<input type="text" id="username" name="username" required />
				</div>
				<div class="form-group password-wrapper">
					<label for="password">Пароль:</label>
					<input type="password" id="password" name="password" required />
					<button type="button" id="toggle-login-pass" class="toggle-password" aria-label="Показать пароль" title="Показать пароль">
						
						<svg id="icon-eye-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<path d="M3 3l18 18" />
							<path d="M10.584 10.587a2 2 0 1 0 2.828 2.827" />
							<path d="M6.712 6.715c-1.766 1.233-3.247 2.89-4.712 5.285c2.667 4 6.667 6 10 6c1.25 0 2.47-.214 3.638-.623" />
							<path d="M9.88 4.598a9.956 9.956 0 0 1 2.12-.598c3.333 0 7.333 2 10 6c-1.093 1.64-2.3 3.022-3.614 4.047" />
						</svg>
						
						<svg id="icon-eye" style="display:none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<path d="M2 12c2.667-4 6.667-6 10-6s7.333 2 10 6c-2.667 4-6.667 6-10 6s-7.333-2-10-6z" />
							<circle cx="12" cy="12" r="2" />
						</svg>
					</button>
				</div>
				<div class="form-group" style="display:flex;align-items:center;gap:10px;justify-content:space-between;margin:10px 0 16px;">
					<label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
						<input type="checkbox" id="remember_me" />
						<span>Запомнить меня</span>
					</label>
				</div>
				<button type="submit" class="button button-primary" style="width: 100%">
					Войти
				</button>
			</form>
		</div>
	<script>

		// Переключатель видимости пароля на странице логина
		(function(){
			const btn = document.getElementById('toggle-login-pass');
			const input = document.getElementById('password');
			if (!btn || !input) return;
			const eye = document.getElementById('icon-eye');
			const eyeOff = document.getElementById('icon-eye-off');
			btn.addEventListener('click', () => {
				if (input.type === 'password') {
					input.type = 'text';
					btn.setAttribute('aria-label', 'Скрыть пароль');
					btn.title = 'Скрыть пароль';
					if (eye) eye.style.display = '';
					if (eyeOff) eyeOff.style.display = 'none';
				} else {
					input.type = 'password';
					btn.setAttribute('aria-label', 'Показать пароль');
					btn.title = 'Показать пароль';
					if (eye) eye.style.display = 'none';
					if (eyeOff) eyeOff.style.display = '';
				}
			});
		})();

		// Запомнить логин (username) локально
		(function(){
			const u = document.getElementById('username');
			const r = document.getElementById('remember_me');
			if (!u || !r) return;
			try {
				const saved = localStorage.getItem('login_username');
				if (saved) { u.value = saved; r.checked = true; }
			} catch(_){}
			// При отправке формы — сохранить/очистить
			u.form?.addEventListener('submit', () => {
				try {
					if (r.checked) localStorage.setItem('login_username', u.value || '');
					else localStorage.removeItem('login_username');
				} catch(_){ }
			});
		})();
	</script>
	</body>
</html>
